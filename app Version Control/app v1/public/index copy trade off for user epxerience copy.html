<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Musicaid â€” The Musically Social App</title>
    <link rel="icon" href="images/background.png">
    <link rel="stylesheet" href="css/style.css">
    <script src="https://code.jquery.com/jquery.js"></script>
    
  <script>
    "use strict";
    $().ready(function(){
        $("#result").hide();
        $("#formArea").hide();
        
        $("#albumSearch").on("click", function(e){
                e.preventDefault();
                $("#formArea").show();
                $("#artistForm").hide();
                $("#albumForm").show();
                $("#trackForm").hide();
        });
        $("#artistSearch").on("click", function(e){
                e.preventDefault();
                $("#formArea").show();
                $("#albumForm").hide();
                $("#artistForm").show();
                $("#trackForm").hide();
        });
        $("#trackSearch").on("click", function(e){
                e.preventDefault();
                $("#formArea").show();
                $("#albumForm").hide();
                $("#artistForm").hide();
                $("#trackForm").show();
        });
        
        $("#submit").on("click", function(e){
            
            //$("#artistForm").hide();
            $("#result").show();

            e.preventDefault();
            
            
            //get value from fields.
            var data = {
                albumName: $("#typeAlbum").val()
            };
            
//            $.post("/formdata",data,function(result){
//                result = JSON.parse(result); //turn the string into a JavaScript object
//                console.log(result);
//                var html = "<li>Name: " + result.fullName + "</li>";
//                $("#result > ul").html(html);
//
//            });
            $.post("/albums",data,function(result){
                result = JSON.parse(result); //turn the string into a JavaScript object
                console.log(result); //log results into console on client side
                
                var items = result;
                //console.log(items);
                var resultArea = $("#resultArea");
                $('#resultArea').html('');
                //result = "";
                
                var headingRow = $("<tr></tr>");

                var headings = "<th>Album Art</th>";
                headings += "<th> Album </th>";
                headings += "<th> Artist </th>";
                headingRow.append(headings);
                resultArea.append(headingRow);
                
                for (var i = 0; i<items.length; i++)
                {
                    var item = items[i];
                    var output = '<td>' + '<img src="' + item.albumImage + '">' + '</td>'; 
                    output += "<td>" + item.albumName + "</td>";
                    output += "<td>" + item.albumArtist + "</td>";
                    //output += "<td>" + item.albumID + "</td>";
//                    var artists = item.artists;
//                    for (var j = 0; j<artists.length; j++) 
//                    {
//                    var artist = artists[j];
//                    output += "artist: " + artist.name + "<br/>";
//                    }
                var para = $("<tr></tr>");
                para.html(output);
                resultArea.append(para);
                }
//            var html = "<li>Name: " + result.fullName + "</li>";
//                $("#result > div").html(html);

            });
        });
        
        $("#submitArtist").on("click", function(e){
            //$("#artistForm").hide();
            $("#result").show();

            e.preventDefault();
            
            
            //get value from fields.
            var data = {
                artistName: $("#typeArtist").val()
            };
            console.log(data); // for testing check developer tools
            
            $.post("/artists",data,function(result){
                result = JSON.parse(result); //turn the string into a JavaScript object
                console.log(result); //log results into console on client side
                
                var items = result;
                console.log(items);
                var resultArea = $("#resultArea");
                $('#resultArea').html('');
                
                var headingRow = $("<tr></tr>");

                var headings = "<th>Artist Name</th>";
                headings += "<th> </th>";
                headings += "<th>  </th>";
                headingRow.append(headings);
                resultArea.append(headingRow);


                for (var i = 0; i<items.length; i++)
                {
                     var item = items[i];
                     var output = "<td>" + item.artistName + "</td>";
                    output += "<td>" + '<img src="' + item.artistImage.url + '"></td>'; 
                    //output += "<td>"  + item.id + "</td>";
                    output += "<td>"  + '<button id= "' + item.artistID + '">' + 'Add' + "</button>" + "</td>";

                    //var artists = item.artists;
                    // for (var j = 0; j<artists.length; j++) 
                    // {
                    // var Track = artists[j];
                    // output += "Track: " + Track.name + "<br/>";
                    // }
                    var para = $("<tr></tr>");//create a row
                    para.html(output);
                    resultArea.append(para);
               }
            
        });
    });
        
    var trackInfo = [];
    var artistInfo = [];
    var albumInfo = [];
        
    //$("#submitTrack").on("click", function(e){
    $("button").on("click", function(e){
            //$("#artistForm").hide();
            $("#result").show();

            e.preventDefault();
            
            var type = $("#type");
    
            //get value from fields.
            var data = {
                trackName: $("#typeTrack").val()
            };
            /*
                console.log(data); // for testing check developer tools
            */
            $.post("/tracks",data,function(result){
                console.log(result);
                
                /*
                result = JSON.parse(result);
                console.log(result);
                */
                
                var resultArea = $("#resultArea");
                $('#resultArea').html(result);
                /*result = JSON.parse(result); //turn the string into a JavaScript object
                console.log(result); //log results into console on client side
                */ //HIDDEN FEB 27 18
                
                var items = result;
                
                var resultArea = $("#resultArea");
                $('#resultArea').html('');
                
    if (type = "track"  || "TRACK")
    {
                var headingRow = $("<tr></tr>");

                var headings = "<th> Name</th>";
                headings += "<th> Artist</th>";
                headings += "<th> Time </th>";
                headings += "<th> </th>";
                headingRow.append(headings);
                resultArea.append(headingRow);


                for (var i = 0; i<items.length; i++)
                {
                     var item = items[i];
                     trackInfo[item.trackID]=item; //Associative array   
                     var output = "<td>" + item.trackName + "</td>";
                     //output += "<td>" + '<img src="' + item.trackArtist + '">' + '</td>'; 
                     output += "<td>"  + item.trackArtist + "</td>";
                     output += "<td>"  + item.trackLength + "</td>";
                    //output += "<td>"  + '<button id= "' + item.trackID + '">' + 'Add' + "</button>" + "</td>";
                    //output += "<td>"  + '<a href="/add"><button id= "' + item.trackID + '">' + 'Add' + "</button></a>" + "</td>";
                    var button = $("<button></button>");
                    button.attr("id", item.trackID);
                    button.addClass("addBtn");
                    button.html("Add");
                    var td = $("<td></td>");
                    td.append(button);
                    button.click(postData);
                    
                    
                    var para = $("<tr></tr>");//create a row
                    para.append(output);
                    para.append(td);
                    resultArea.append(para);
               }
   }
            });
   
        
    });
    
    function postData(){
       //alert("INSIDE BUTTON!");
        var id = $(this).attr("id"); 
        var data = {
        item: trackInfo[id] 
        };
        
       //console.log(item);
        $.post("/saveTrack",data,function(result){
            //console.log(result);
            console.log("Track Has Been Saved..");
        });
    };
        
});
    </script>
</head>
<body>
    <!--<h1>music a.i.d</h1>-->
    <center>"the future of musically social"</center>
    <center>issa test user interface! by: ajm</center>
    <!--
    <a href="" id="albumSearch">search album</a>
    <a href="" id="artistSearch">search artist</a>-->
    <a href="/collection" id="">view my collection</a>
    <a href="" id="trackSearch">search track</a>
    
    <h1>SEARCH</h1>

    <div id="formArea">
    <h3></h3>
    <form method="POST" action="">
       
        <fieldset id="albumForm">
        <br/>
        <label>search for an album:</label> 
        <input type="text" id="typeAlbum">
        <button id = "submit">search</button>
        </fieldset>
        
        
        <fieldset id="artistForm">
        <br/>
        <label>search for an artist:</label> 
        <input type="text" id="typeArtist">
        <button id = "submitArtist">search</button>
        </fieldset>
        
        <fieldset id="trackForm">
        <br/>
        <label>search for an track:</label>
        <br/>
        <select id="type">
        <option>OPTION 1</option>    
        <option>OPTION 2</option>    
        <option>TRACK</option>    
        </select>
        <input type="text" id="typeTrack">
        <button id = "submitTrack">search</button>
        </fieldset>
        <!--
        <input type="submit" id = "submit" name = "Submit">
        -->
    </form>
    </div>
    
    <!--This div will be hiding until i click add-->
<!--
    <div id="userPrompt">
        <label>please enter your username:</label><br/>
        <input></input><br/>
    </div>
-->

    <div id="result">
        <h3>Results!</h3>
        <a href="/search" id="again">phone home (go home roger!)</a>
        <a href="/collection" id="">view my collection</a>

        <table id="resultArea">
        </table>
    </div>
   
    
</body>
</html>